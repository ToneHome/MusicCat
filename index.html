<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="keywords"
      content="search,music,Categries,Genres,DANCE,ELECTRONIC,CINEMATIC,HOLIDAY"
    />
    <meta
      name="description"
      content="search,music,Categries,Genres,DANCE,ELECTRONIC,CINEMATIC,HOLIDAY"
    />
    <title>Music Categries</title>
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Oswald&display=swap"
    />
    <link rel="stylesheet" href="./static/css/normalize.css" />
    <link rel="stylesheet" href="./static/css/index.css" />
    
  </head>
  <body>
    <header>
      <h1>Categries</h1>
      <a href="javascript:void(0)" target="_blank" rel="noopener noreferrer">
        <img src="./static/img/direction-left.png" alt="" />
      </a>
    </header>
    <main>
      <section class="s-section">
        <input placeholder="Seach Music" type="text" />
        <i class="s-icon"></i>
      </section>
      <section class="m-panel">
        <h2>Genres</h2>
        <article>
          <div class="m-item">
            <span>
              DANCE
            </span>
            <span>&</span>
            <span>
              ELECTRONIC
            </span>
          </div>
          <div class="m-item">
            <span>CINEMATIC</span>
          </div>
          <div class="m-item">
            <span>HOLIDAY</span>
          </div>
          <div class="m-item">
            <span>
              DANCE
            </span>
            <span>&</span>
            <span>
              ELECTRONIC
            </span>
          </div>
          <div class="m-item">
            <span>CINEMATIC</span>
          </div>
          <div class="m-item">
            <span>HOLIDAY</span>
          </div>
          <div class="m-item">
            <span>
              DANCE
            </span>
            <span>&</span>
            <span>
              ELECTRONIC
            </span>
          </div>
          <div class="m-item">
            <span>CINEMATIC</span>
          </div>
        </article>
      </section>
      <section class="m-panel">
        <h2>Moods</h2>
        <article>
          <article>
            <div class="m-item">
              <span>
                DANCE
              </span>
              <span>&</span>
              <span>
                ELECTRONIC
              </span>
            </div>
            <div class="m-item">
              <span>CINEMATIC</span>
            </div>
            <div class="m-item">
              <span>HOLIDAY</span>
            </div>
            <div class="m-item">
              <span>
                DANCE
              </span>
              <span>&</span>
              <span>
                ELECTRONIC
              </span>
            </div>
            <div class="m-item">
              <span>CINEMATIC</span>
            </div>
            <div class="m-item">
              <span>HOLIDAY</span>
            </div>
            <div class="m-item">
              <span>
                DANCE
              </span>
              <span>&</span>
              <span>
                ELECTRONIC
              </span>
            </div>
            <div class="m-item">
              <span>CINEMATIC</span>
            </div>
          </article>
        </article>
      </section>
    </main>

    <script>
        
  
        const data = {
          Genres: [
            {
              title: "DANCE&ELECTRONIC",
              img: "", // 缺省
            },
            {
              title: "CINEMATIC",
              img: "", // 缺省
            },
            {
              title: "HOLIDAY",
              img: "", // 缺省
            },
            {
              title: "DANCE&ELECTRONIC",
              img: "", // 缺省
            },
            {
              title: "CINEMATIC",
              img: "", // 缺省
            },
            {
              title: "HOLIDAY",
              img: "", // 缺省
            },
            {
              title: "DANCE&ELECTRONIC",
              img: "", // 缺省
            },
            {
              title: "CINEMATIC",
              img: "", // 缺省
            },
            {
              title: "HOLIDAY",
              img: "", // 缺省
            },
          ],
          Moods: [
            {
              title: "DANCE&ELECTRONIC",
              img: "", // 缺省
            },
            {
              title: "CINEMATIC",
              img: "", // 缺省
            },
            {
              title: "HOLIDAY",
              img: "", // 缺省
            },
            {
              title: "DANCE&ELECTRONIC",
              img: "", // 缺省
            },
            {
              title: "CINEMATIC",
              img: "", // 缺省
            },
            {
              title: "HOLIDAY",
              img: "", // 缺省
            },
            {
              title: "DANCE&ELECTRONIC",
              img: "", // 缺省
            },
            {
              title: "CINEMATIC",
              img: "", // 缺省
            },
            {
              title: "HOLIDAY",
              img: "", // 缺省
            },
          ],
        };
  
        function getHtmlByItem(item) {
          let itemKeyAry = item.title.split("&");
          console.log('itemKeyAry: ', itemKeyAry);
          let spans = "";
          let isEmptyClass = ''
          if (itemKeyAry.length === 1) {
              if(!itemKeyAry[0]){
                isEmptyClass = 'm-item-null';
              }
            spans = `<span>${itemKeyAry[0]}</span>`;
          } else {
            itemKeyAry.map((span, index) => {
              spans += `<span>${itemKeyAry[index]}</span>`;
              if (index != itemKeyAry.length -1) {
                spans += `<span>&</span>`;
              }
            });
          }
          return `<div class="m-item ${isEmptyClass}">${spans}</div>`;
                  
        }
  
        function render() {
            document.querySelectorAll('.m-panel').forEach(item =>{
              item.remove()
            })
            let lastHtml = ''
            let panelWidth = document.querySelector('main').clientWidth;
            console.log('panelWidth: ', panelWidth);
            Object.keys(data).forEach(element => {
              let innerHtml = ``
              let titleHtml = `<h2>${element}</h2>`
              let needGroup = true,groupNum = 3
              if(panelWidth <= 750){
                  needGroup = false
                  data[element].map(item => {
                      innerHtml += getHtmlByItem(item)
                  })    
              }
              else if(panelWidth < 1000){
                  groupNum =3
              }else if(panelWidth < 1250){
                  groupNum = 4
              }else if(panelWidth < 1520){
                  groupNum = 5
              }else if(panelWidth < 1760){
                  groupNum = 6
              }else{
                  groupNum = 7
              }
  
              if(needGroup){
                  const result = [];
                  const item = data[element]
                  for(var i=0;i<item.length;i+=groupNum){
                      let _rsItem = item.slice(i,i+groupNum)
                      if(_rsItem.length < groupNum){
                        while(_rsItem.length < groupNum){
                            _rsItem.push({
                                title:''
                            })
                        }
                      }
                      result.push(_rsItem);
                  }
                  result.forEach(rsItem => {
                      let itemSection = ''
                      rsItem.forEach(rsChildItem => {
                          itemSection += getHtmlByItem(rsChildItem)
                          
                      })
                      innerHtml += `<div class='item-group'>${itemSection}</div>`
                  })
  
              }
              let section = `<section class="m-panel">${titleHtml}<article>${innerHtml}</article></section>`
              document.querySelector('main').innerHTML = document.querySelector('main').innerHTML + section;
            });
        }
        render()

        window.onresize = function () {
          setFontSize();
        };
        setFontSize();
        function setFontSize() {
          let clientWidth = document.documentElement.clientWidth;
          clientWidth = clientWidth > 750 ? 750 : clientWidth;
          document.documentElement.style.fontSize =
            10 * (clientWidth / 375) + "px";
            render();
        }
      </script>
  </body>
</html>
